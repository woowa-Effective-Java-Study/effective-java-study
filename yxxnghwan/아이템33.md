# ì•„ì´í…œ33 íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ

## íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆë€?ğŸ§

### ì»¨í…Œì´ë„ˆ
`Set<E>`, `Map<K, V>`, `List<T>` ë“± ì—¬ëŸ¬ ìš”ì†Œë¥¼ ë‹´ëŠ” ì»¬ë ‰ì…˜ë“¤ê³¼
`ThreadLocal<T>`, `AtomicReference<T>`ë“± ë‹¨ì¼ì›ì†Œë¥¼ ë‹´ëŠ” í´ë˜ìŠ¤ë“¤.


### íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ
ì—¬ëŸ¬ íƒ€ì…ì„ ì•ˆì „í•˜ê²Œ ë‹´ì„ ìˆ˜ ìˆëŠ” ì»¨í…Œì´ë„ˆ

`List<Integer>`ëŠ” ì˜¤ì§ Integer íƒ€ì…ë§Œ ë‹´ì„ ìˆ˜ ìˆìŒ. ê·¸ëŸ¼ ì—¬ëŸ¬ íƒ€ì…ì„ ë‹´ê²Œ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?

### Objectì— ì €ì¥í•˜ê¸°

```java
public class ObjectContainer {
    public static void main(String[] args) {
        List<Object> container = new ArrayList<>();
        container.add("1");
        container.add(1);
        container.add(1L);
        container.forEach(System.out::println);
    }
}
```

í•˜ì§€ë§Œ, ìœ„ ë°©ë²•ëŒ€ë¡œ ì‚¬ìš©í•  ê²½ìš° í•´ë‹¹ ì»¨í…Œì´ë„ˆì—ì„œ ì–»ì€ ê°ì²´ê°€ ì–´ë–¤ íƒ€ì…ì¸ì§€ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì–¸ì œ ëŸ°íƒ€ì„ ì—ëŸ¬ê°€ ë°œìƒí• ì§€ ëª¨ë¥¸ë‹¤. ìœ„ ì½”ë“œì˜ ê²½ìš° sysoutì´ Object íƒ€ì…ìœ¼ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ê¸° ë•Œë¬¸ì— ëŸ°íƒ€ì„ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤.

### í´ë˜ìŠ¤ íƒ€ì…ì„ Keyë¡œ ì¡ì•„ì„œ ì‚¬ìš©í•˜ë©´?

```java
public class ClassTypeKeyContainer {
    public static void main(String[] args) {
        Map<Class<?>, Object> container = new HashMap<>();
        container.put(Integer.class, 1);
        container.put(String.class, "1");

        String item = (String) container.get(String.class);
    }
}
```

íƒ€ì…ì„ ì˜ˆìƒí•  ìˆ˜ëŠ” ìˆë‹¤. í•˜ì§€ë§Œ ì»¨í…Œì´ë„ˆì— ê°’ì„ ë„£ì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ ë„£ëŠ”ë‹¤ë©´..?

```java
public class ClassTypeKeyContainer {
    public static void main(String[] args) {
        Map<Class<?>, Object> container = new HashMap<>();
        container.put(Integer.class, "1");

        Integer item = (Integer) container.get(Integer.class);
    }
}
```
ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šê³  ëŸ°íƒ€ì„ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. Integer í‚¤ì— String ê°’ì„ ë„£ì—ˆê¸° ë•Œë¬¸ì— í˜•ë³€í™˜ì‹œì— `ClassCastException`ì´ ë°œìƒí•œë‹¤.

## íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ

ì•ì„  ë‘ ì¼€ì´ìŠ¤ì—ì„œëŠ” ì»¨í…Œì´ë„ˆì— ì—¬ëŸ¬ íƒ€ì…ì„ ë‹´ì„ ìˆ˜ëŠ” ìˆì—ˆì§€ë§Œ, íƒ€ì… ì•ˆì •ì„±ì„ ë³´ì¥í•  ìˆ˜ ì—†ì—ˆë‹¤. íƒ€ì… ì•ˆì „ì„±ì„ ë³´ì¥í•˜ëŠ” `íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ`ì— ëŒ€í•´ ì•Œì•„ë³´ì.

ì œë„¤ë¦­ì„ í™œìš©í•œ íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆ
```java
public class Favorites {
    private Map<Class<?>, Object> favorites = new HashMap<>();

    public <T> void putFavorite(Class<T> type, T instance) {
        favorites.put(Objects.requireNonNull(type), instance);
    }

    public <T> T getFavorite(Class<T> type) {
        return type.cast(favorites.get(type));
    }
}
```

í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ
```java
public static void main(String[] args) {
    Favorites f = new Favorites();
    
    f.putFavorite(String.class, "Java");
    f.putFavorite(Integer.class, 0xcafebabe);
    
    String favoriteString = f.getFavorite(String.class);
    int favoriteInteger = f.getFavorite(Integer.class);
    
    System.out.printf("%s %x %n", favoriteString, favoriteInteger);
}
```

ì œë„¤ë¦­ì„ ì´ìš©í•´ì„œ `putFavorite`ë©”ì„œë“œë¥¼ êµ¬í˜„í–ˆë‹¤. íƒ€ì… í‚¤ì— ë§ì§€ ì•Šìœ¼ë©´ ë©”ì„œë“œì—ì„œ ì»´íŒŒì¼ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.
ì¦‰, ìœ„ì— íƒ€ì… ì•ˆì •ì„±ì„ ë³´ì¥í•˜ì§€ ëª»í•œ ì¼€ì´ìŠ¤ì—ì„œ Objectì— ë§ì§€ ì•ŠëŠ” íƒ€ì…ì„ ë„£ëŠ” ê²½ìš°ë¥¼ ë°°ì¬í–ˆë‹¤.

ê·¸ë¦¬ê³  ë§ˆì°¬ê°€ì§€ë¡œ ì œë„¤ë¦­ìœ¼ë¡œ `getFavorite`ë©”ì„œë“œì—ì„œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ë”°ë¡œ ìºìŠ¤íŒ…ì´ í•„ìš” ì—†ë„ë¡ í–ˆë‹¤. `Class`ì˜ `cast()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì…ë ¥ëœ í‚¤ì— ë§ëŠ” íƒ€ì…ì´ ìë™ìœ¼ë¡œ ë°˜í™˜ëœë‹¤.

**cast()** : í˜•ë³€í™˜ ì—°ì‚°ìì˜ ë™ì  ë²„ì „

---

## íƒ€ì… ì•ˆì „ ì´ì¢… ì»¨í…Œì´ë„ˆê°€ ì™„ì „í•˜ì§€ ëª»í•œ ì´ìœ ...ğŸ¥²

### ì•…ì˜ì ì¸ í´ë¼ì´ì–¸íŠ¸ê°€ Classê°ì²´ë¥¼ ì œë„¤ë¦­ ì—†ì´ ë¡œíƒ€ì…ìœ¼ë¡œ ë„˜ê¸°ëŠ” ê²½ìš°
<br/>

ìœ„ì˜ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì—ì„œ ì»¨í…Œì´ë„ˆì— ë‹¤ìŒì²˜ëŸ¼ ë‹´ëŠ”ë‹¤ê³  ê°€ì •í•˜ë©´,
```java
f.putFavorite((Class)Integer.class, "I'm malicious Alexander HaHaHa!!!");
int favoriteInteger = f.getFavorite(Integer.class);
```
ë“¤ì–´ê°ˆ ë• ì•„ë¬´ ë¬¸ì œ ì—†ì´ ë“¤ì–´ê°€ì§€ë§Œ, êº¼ë‚¼ ë•Œ Integeríƒ€ì…ìœ¼ë¡œ êº¼ë‚´ë ¤í•˜ë©´ `ClassCastException`ì´ ë°œìƒí•œë‹¤.

ì´ëŸ° ê²½ìš°ë¥¼ ì˜ˆë°©í•˜ë ¤ë©´ ì»¨í…Œì´ë„ˆì— ë‹´ëŠ” ë©”ì„œë“œì—ì„œ í˜•ë³€í™˜ ê²€ì‚¬ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ë²•ì´ ìˆëŠ”ë°,
```java
public <T> void putFavorite(Class<T> type, T instance) {
    favorites.put(Objects.requireNonNull(type), type.cast(instance));
}
```

ì´ë ‡ê²Œ êµ¬í˜„í•  ê²½ìš° ì»¨í…Œì´ë„ˆì— ë„£ì„ ë•Œ `ClassCastException`ì´ ë°œìƒí•œë‹¤. ì–´ì¨Œë“  ì»´íŒŒì¼ íƒ€ì„ì— ì¡ì•„ë‚¼ ìˆ˜ëŠ” ì—†ë‹¤.

### ì‹¤ì²´í™” ë¶ˆê°€ íƒ€ì…ì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
<br/>

ì–´ë–¤ ë§ì´ëƒë©´ `List<String>`ê°™ì€ íƒ€ì…ì˜ ê²½ìš° ì €ì¥í•  ìˆ˜ ì—†ë‹¤. ì´ìœ ëŠ” `List<String>`ì˜ `Class`ê°ì²´ë¥¼ ì–»ì„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤. `List<String>.class`ëŠ” ë¬¸ë²• ì˜¤ë¥˜ì´ë‹¤. `List.class`ë¼ëŠ” ê°™ì€ Classê°ì²´ë¥¼ ì“°ê¸° ë•Œë¬¸ì— ë§Œì•½ `List.class`ë¡œ `List<String>`ì™€ `List<Integer>`ë¥¼ ëª¨ë‘ í—ˆìš©í•´ì„œ ì‚¬ìš©í•˜ë©´.... ì»¨í…Œì´ë„ˆëŠ” ì œ ê¸°ëŠ¥ì„ í•  ìˆ˜ ì—†ì„ ê²ƒì´ë‹¤. [(ë¡œíƒ€ì…ì„ ì“°ë©´ ì•ˆë˜ëŠ” ì´ìœ )](https://github.com/woowa-Effective-Java-Study/effective-java-study/blob/main/2yujeong/item_26.md)

## ë—